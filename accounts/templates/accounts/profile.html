{% extends 'dashboard/base.html' %}
{% load static %}
{% block content %}
<div class="container mt-4">
  <div class="card dashboard-card p-4" style="max-width:720px; margin:auto;">
    <h3 class="fw-semibold mb-3 text-center">ðŸ‘¤ Your Profile</h3>

    {% if not request.user.is_authenticated %}
      <div class="alert alert-info">Please <a href="{% url 'login' %}">log in</a> to view your profile.</div>
    {% else %}
      <div class="text-center mb-3">
        {% comment %} If you have an accounts.Profile with avatar, you can show it here {% endcomment %}
        <img src="{% static 'img/user.avif' %}" class="rounded-circle" width="120" height="120" style="object-fit:cover;">
        <p class="mt-2 fw-semibold">{{ request.user.username }}</p>
      </div>

      <form method="post" class="mb-3">
        {% csrf_token %}
        <input type="hidden" name="action" value="update_basic">
        <div class="mb-2">
          <label class="form-label">Username</label>
          <input name="username" class="form-control" value="{{ request.user.username }}">
        </div>
        <div class="mb-2">
          <label class="form-label">Email</label>
          <input name="email" class="form-control" value="{{ request.user.email }}">
        </div>
        <button class="btn btn-primary w-100" type="submit">Save changes</button>
      </form>

      <hr>
      <h5>Change password</h5>
      <form method="post" class="mb-3">
        {% csrf_token %}
        <input type="hidden" name="action" value="change_password">
        <div class="mb-2">
          <label class="form-label">Current password</label>
          <input name="current_password" type="password" class="form-control">
        </div>
        <div class="mb-2">
          <label class="form-label">New password</label>
          <input name="new_password" type="password" class="form-control">
        </div>
        <div class="mb-2">
          <label class="form-label">Confirm new password</label>
          <input name="confirm_password" type="password" class="form-control">
        </div>
        <button class="btn btn-warning w-100" type="submit">Change password</button>
      </form>

      <hr>
      <h5>Danger zone</h5>
      <form method="post" onsubmit="return confirm('This will permanently delete your account. Type DELETE in the text field and press Delete.')">
        {% csrf_token %}
        <input type="hidden" name="action" value="delete_account">
        <div class="mb-2">
          <label class="form-label">Type DELETE to confirm</label>
          <input name="confirm_delete" class="form-control" placeholder="Type DELETE to confirm">
        </div>
        <button class="btn btn-danger w-100" type="submit">Delete account</button>
      </form>
    {% endif %}

  </div>
</div>
{% endblock %}
