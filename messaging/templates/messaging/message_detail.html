{% extends "dashboard/base.html" %}
{% block content %}
<div class="container mt-4">

  <a href="{% url 'inbox' %}" class="btn btn-secondary btn-sm mb-3">Back to Inbox</a>

  <div class="card dashboard-card p-4">
    <h3 class="fw-bold">{{ msg.subject }}</h3>

    <p class="text-muted">
      From: {{ msg.sender.username }}<br>
      To: {{ msg.recipient.username }}<br>
      {{ msg.created_at|date:"Y-m-d H:i" }}
    </p>

    <p class="mt-3">{{ msg.body|linebreaks }}</p>

    {% if msg.attachment %}
      <div class="mt-3">
        <strong>Attachment:</strong><br>
        <a href="{{ msg.attachment.url }}" download class="btn btn-outline-light btn-sm">
          Download File
        </a>

        {% if msg.attachment.url|lower|endswith:".png" or
              msg.attachment.url|lower|endswith:".jpg" or
              msg.attachment.url|lower|endswith:".jpeg" or
              msg.attachment.url|lower|endswith:".webp" %}
          <img src="{{ msg.attachment.url }}" class="img-fluid rounded mt-2">
        {% endif %}
      </div>
    {% endif %}

    <div class="d-flex gap-2 mt-4">
      <a href="{% url 'reply_message' msg.id %}" class="btn btn-primary">Reply</a>
      <a href="{% url 'message_delete' msg.id %}" class="btn btn-outline-warning">Move to Trash</a>
    </div>

  </div>

</div>
{% endblock %}
